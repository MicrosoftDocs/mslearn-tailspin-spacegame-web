         parameters:
           buildConfiguration: 'Release'
           
         steps:
         - task: DotNetCoreCLI@2
           displayName: 'Build the project - ${{ parameters.buildConfiguration }}'
           inputs:
             command: 'build'
             arguments: '--no-restore --configuration ${{ parameters.buildConfiguration }}'
             projects: '**/*.csproj'
         - task: DotNetCoreCLI@2
           displayName: 'Install ReportGenerator'
           inputs:
             command: custom
             custom: tool
             arguments: 'install --global dotnet-reportgenerator-globaltool'

         - task: DotNetCoreCLI@2
           displayName: 'Run unit tests - $(buildConfiguration)'
           inputs:
             command: 'test'
             arguments: '--no-build --configuration $(buildConfiguration) /p:CollectCoverage=true /p:CoverletOutputFormat=cobertura /p:CoverletOutput=$(Build.SourcesDirectory)/TestResults/Coverage/'
             publishTestResults: true
             projects: '**/*.Tests.csproj'

         - script: reportgenerator -reports:$(Build.SourcesDirectory)/**/coverage.cobertura.xml -targetdir:$(Build.SourcesDirectory)/CodeCoverage -reporttypes:HtmlInline_AzurePipelines
           displayName: 'Create code coverage report'

         - task: DotNetCoreCLI@2
           displayName: 'Publish the project - ${{ parameters.buildConfiguration }}'
           inputs:
             command: 'publish'
             projects: '**/*.csproj'
             publishWebProjects: false
             arguments: '--no-build --configuration ${{ parameters.buildConfiguration }} --output $(Build.ArtifactStagingDirectory)/${{ parameters.BuildConfiguration }}'
             zipAfterPublish: true

